# 로그인 인증 방식

## 로그인 인증 방식 종류

### 1. 쿠키
쿠키는 클라이언트에 저장되는 `key`와 `value`로 이루어진 데이터이다.<br>
인증 유효 시간을 설정할 수 있고, 유효 시간이 정해진다면 클라이언트가 종료되어도 쿠키가 유지된다.<br>
서버와의 요청&응답으로 인해 쿠키가 저장되면 다음 요청은 쿠키에 담긴 정보를 이용해 참조한다.<br>

- 쿠키 동작 방식
1. 클라이언트가 로그인 요청.
2. 서버에서 쿠키 생성 후 클라이언트로 전달.
3. 클라이언트가 서버로 요청을 보낼 때 쿠키를 전송.
4. 쿠키를 이용해 유저 인증을 진행.

- 문제점 <br>
사용자 인증에 대한 정보를 모두 클라이언트가 가지고 있어서 http요청을 탈취당할 경우, 쿠키 자체를 탈취당해 사용자 정보를 모두 잃어 버릴 수 있다. 그래서 쿠키 자체는 보안과 큰 상관이 없는 장바구니, 자동로그인 설정 등에 이용된다.<br>

### 2. 세션
세션은 쿠키를 기반으로 하지만 클라이언트에 저장하는 쿠키와는 다르게 서버에 저장하여 관리한다. <br>
서버에서는 클라이언트를 구별하기 위해 각각의 세션ID를 클라이언트마다 부여하게 되며 클라이언트가 종료되기 전까지 유지한다.<br>
쿠키보다 보안이 우수.<br>

- 세션 동작 방식
1. 클라이언트가 로그인 요청.
2. 서버에서 클라이언트의 고유 세션ID 부여 & 세션 저장소에 저장한 후 발급.
3. 클라이언트는 발급받은 세션ID를 쿠키에 저장하게 되고, 요청을 보낼 때마다 쿠키를 보냄.
4. 서버는 쿠키에 담겨있는 세션ID와 세션 저장소에 있는 정보를 대조한 후 데이터를 가져옴.

- 문제점 <br>
세션 하이재킹 공격이 가능하였으나 세션의 유효시간을 만들어 예방하고 있다. 그러나 동시 접속자가 많아지는 경우, 세션 저장소를 서버에서 관리하는 문제로 인해 서버에 걸리는 부하가 커질 수 있다.

### 3. 토큰(JWT)
JWT은 인증에 필요한 정보들을 암호화시킨 토큰을 말한다. 세션처럼 토큰 자체를 쿠키에 담아서 보내줄 수도 있고 HTTP 헤더에 담아서 보내 줄 수 있다.<br>

- 토큰 동작 방식
1. 클라이언트가 로그인 요청.
2. 서버에서 유저의 고유한 ID와 기타 인증 정보들을 함께 담는다.
3. 옵션으로 토큰의 유효기간을 설정한다.
4. 시크릿키를 이용해 토큰을 발급한다.
5. 발급된 토큰은 클라이언트에 쿠키 혹은 로컨스토리지 등에 저장하여 요청을 보낼 때마다 같이 보낸다.
6. 서버에서는 받은 토큰을 시크릿키로 복호화하여 검증한다.
7. 검증이 완료되면 데이터를 전송한다.

- 특징 <br>
세션보다 간편하여 검증하는 과정만 거치면 된다. 그러나 발급된 JWT는 삭제가 불가능하여 토큰을 탈취당하면 유효시간 종료까지 탈취자가 토큰을 악의적으로 사용 할 수 있다. `Refresh Token`을 이용해 피해를 줄일 수 있다.

